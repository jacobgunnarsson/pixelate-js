/*!
pixelate-js - v0.1.0 - 2013-07-22
                        
Author: Jacob Gunnarsson                        
Contact: hello@jacobgunnarsson.com                        

http://www.jacobgunnarsson.com/                        
https://github.com/jacobgunnarsson                        
*/

var Pixelate=function(a,b){"use strict";var c=this;this.defaults={cellSize:30,animate:!1,cellStartSize:null,cellEndSide:null,frameWidth:null,frameHeight:null};for(var d in b)b.hasOwnProperty(d)&&this.defaults[d]&&(this.defaults[d]=b[d]);this.src={element:a},this.cells=[],this.src.element.onload=function(){c.init()}};Pixelate.prototype={init:function(){this.utils.perf.start(),this.parseImage()},createCanvas:function(a,b){var c=this.src,d=document.createElement("canvas");return d.id=a,d.width=c.width,d.height=c.height,b&&c.element.parentNode.appendChild(d),d},parseImage:function(){var a,b,c=this.src.element;a=this.src.width=c.width||c.naturalHeight,b=this.src.height=c.height||c.naturalHeight,this.src.style=c.style;var d=this.createCanvas("pixelate-tmp-canvas",!1),e=d.getContext&&d.getContext("2d");e||this.utils.error("Unsupported browser, pixelate.js requires an HTLM5 capable browser"),this.fetchCells(e)},fetchCells:function(a){var b=this.src.width,c=this.src.height,d=this.defaults.cellSize,e=Math.ceil(b/d),f=Math.ceil(c/d),g=e*f;a.drawImage(element,0,0);for(var h=a.getImageData(0,0,b,c).data,i=[],j=y=Math.ceil(d/2),k=0;g>k;){var l=4*(j+y*b),m=[h[l],h[l+1],h[l+2],h[l+3]];i.push(m),j>b?(j=0,y+=d):j+=d,++k}this.cells=i,this.utils.perf.end("Parsed image in "),this.paintImage()},paintImage:function(){var a=this.createCanvas("pixelate-canvas",!0),b=a.getContext("2d"),c=this.cells,d=c.length,e=this.defaults.cellSize,f=this.src.width,g=(this.src.height,y=i=0);for(this.utils.perf.start();d>i;){var h=c[i],j="rgba("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")";b.beginPath(),b.rect(g,y,g+e,y+e),b.fillStyle=j,b.fill(),g>f?(g=0,y+=e):g+=e,++i}this.utils.perf.end("Painted image in ")},measureFunc:function(){for(var a=100,b=+new Date,c=0;a>c;++c);var d=+new Date,e=b-d;console.log("Test took "+e+"ms")},utils:{perf:{start:function(){this.startMs=+new Date},end:function(a){this.endMs=+new Date,console.log(a+(this.endMs-this.startMs)+"ms")}},error:function(a){throw"pixelate.js ERROR: "+a}}};